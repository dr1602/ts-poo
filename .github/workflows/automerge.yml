name: Auto-Merge de la Ballenita 游냡

on:
  push:
    branches-ignore:
      - main # Esto evita que el workflow se dispare cuando ya est치s en la principal

jobs:
  automerge:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
      contents: write

    steps:
      # 1. Crear el Pull Request autom치ticamente
      - name: Crear Pull Request
        id: cpr
        uses: peter-evans/create-pull-request@v6
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          branch: ${{ github.ref_name }}
          base: main
          title: "游 Auto-PR: ${{ github.ref_name }}"
          body: "te quiero, gracias por tu esfuerzo 仇벒잺 (Auto-generated)"

      # 2. Hacer el Merge autom치ticamente
      - name: Merge autom치tico
        if: steps.cpr.outputs.pull-request-number != ''
        uses: pascalgn/automerge-action@v0.16.2
        env:
          GITHUB_TOKEN: "${{ secrets.GITHUB_TOKEN }}"
          MERGE_METHOD: "merge"
          MERGE_LABELS: "" # Vac칤o para que lo haga siempre
